---
globs: docker-compose*.yaml, docker-compose*.yml
---

# Docker Compose Files (docker-compose*.yaml) Rules üêô

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ—Ä—Å–∏—é Compose file format 3.8+
- –û—Ä–≥–∞–Ω–∏–∑—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å—ã –ª–æ–≥–∏—á–µ—Å–∫–∏
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞–∫ –∫–æ–¥–∞
- –û–±–µ—Å–ø–µ—á—å—Ç–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞

### –í–µ—Ä—Å–∏—è –∏ –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```yaml
version: '3.8'

services:
  # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤

networks:
  # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–µ—Ç–∏

volumes:
  # –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —Ç–æ–º–∞
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
```yaml
environment:
  - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
  - OPENAI_API_KEY=${OPENAI_API_KEY}
  - DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}
  - REDIS_URL=redis://redis:6379
  - LOG_LEVEL=${LOG_LEVEL:-info}
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

### Healthchecks
```yaml
services:
  xi-manager:
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```yaml
services:
  xi-manager:
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
```

## Best Practices
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ volumes –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω—É —Å–µ—Ç—å
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ restart policies —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ —Ç–∏–ø—É —Å–µ—Ä–≤–∏—Å–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ depends_on –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –∑–∞–ø—É—Å–∫–∞
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ healthchecks –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø–æ—Ä—Ç—ã –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ